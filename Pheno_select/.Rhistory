g=HPOExplorer::load_phenotype_to_genes()
g
length(unique(g$ID))
results <- MultiEWCE::load_example_results()
results\
length(unique(results$Phenotype))
length(unique(results[q<0.05]$Phenotype))
length(unique(results[p<0.05]$Phenotype))
results[CellType=="Kupffer cells ",]
grep("Kupffer",unique(results$CellType))
grep("Kupffer",unique(results$CellType), ignore.case = T)
results2 <- EWCE::load_rdata(fileName = "~/Downloads/Descartes_All_Results_extras.rda")
results2
nrow(results)
length(unique(results2[p<0.05]$Phenotype))
length(unique(results2[p<0.05]$list))
length(unique(results2[q<0.05]$list))
length(unique(results2$list))
nrow(results2[q<0.05])
nrow(results2[q<0.05])/nrow(results2)
77 *6173
grep("Kupffer",unique(results2$CellType))
grep("Kupffer",unique(results2$list))
grep("Kupffer",unique(results2$list), ignore.case = T)
hepatoblasts
grep("hepatoblasts",unique(results2$list), ignore.case = T)
grep("hepatoblasts",unique(results2$CellType), ignore.case = T)
grep("neisserial",unique(results2$CellType), ignore.case = T)
grep("neisserial",unique(results2$list), ignore.case = T)
results2[grep("neisserial",unique(results2$list), ignore.case = T),]
grep("neisserial",unique(results2$list), ignore.case = T, value = )
grep("neisserial",unique(results2$list), ignore.case = T, value = T)
results2[list=="Recurrent Neisserial infections"]
results2[list=="Recurrent Neisserial infections"][q<0.05]
5/10000*100
BiocManager::install("InteractiveComplexHeatmap")
results <- MultiEWCE::load_example_results(multi_dataset = TRUE)
keywords <- "muscle, fatigue, heart"
Terms <- process_search_terms(keywords = keywords)
source("~/Desktop/Rare Disease Celltyping/rare_disease_celltyping_apps/pheno_select/source/functions.R", echo=TRUE)
Terms <- process_search_terms(keywords = keywords)
Terms
DF <- keyword_search_df(Terms = Terms)
results <- HPOExplorer::add_hpo_names(results)
results <- HPOExplorer::add_hpo_name(results)
Phenos <- as.character(unique(results$hpo_name[
stringr::str_detect(results$hpo_name,
pattern = Terms)
]))
Phenos
stringr::str_detect(results$hpo_name,
pattern = Terms)
source("~/Desktop/Rare Disease Celltyping/rare_disease_celltyping_apps/pheno_select/source/functions.R", echo=TRUE)
DF <- keyword_search_df(results=results, Terms = Terms)
DF
Terms
keywords <- "muscle, fatigue, heart"
strsplit(keywords, ",")[[1]]
keywords <- strsplit(keywords, ",")[[1]]|> trimws()
keywords
results <- MultiEWCE::load_example_results(multi_dataset = TRUE)
keywords <- "muscle, fatigue, heart"
DF <- keyword_search_df(Terms = Terms)
DF <- keyword_search_df(results=results, Terms = Terms)
DF
#' @param DF The RD EWCE results subset to be visualised.
#' @param keywords the keyword string (used to create title).
#'
#' @returns a bar chart <ggplot>
#' @export
#' @examples
#' results <- MultiEWCE::load_example_results(multi_dataset = TRUE)
#' keywords <- "muscle, fatigue, heart"
#' DF <- keyword_search_df(results=results, Terms = Terms)
#' plot_phenotype_counts(DF = DF, keywords = keywords)
MultiEWCE::plot_bar_summary(results = DF, group_var = "hpo_name")
source("~/Desktop/Rare Disease Celltyping/rare_disease_celltyping_apps/pheno_select/source/functions.R", echo=TRUE)
DF <- keyword_search_df(results=results, Terms = Terms)
keywords <- "muscle, fatigue, heart"
DF <- keyword_search_df(results=results, keywords = keywords)
plot_phenotype_counts(DF = DF, keywords = keywords)
#' @param DF The RD EWCE results subset to be visualised.
#' @param keywords the keyword string (used to create title).
#'
#' @returns a bar chart <ggplot>
#' @export
#' @examples
#' results <- MultiEWCE::load_example_results(multi_dataset = TRUE)
#' keywords <- "muscle, fatigue, heart"
#' DF <- keyword_search_df(results=results, keywords = keywords)
#' plot_phenotype_counts(DF = DF, keywords = keywords)
MultiEWCE::plot_bar_summary(results = DF, group_var = "hpo_name")
MultiEWCE::plot_bar_summary(results = DF, group_var = "hpo_name", filters=NULL)
shiny::runApp('source')
devtools::install_github("neurogenomics/MultiEWCE", dependencies = TRUE)
runApp('web_app.R')
traceback()
source("~/Desktop/Rare Disease Celltyping/rare_disease_celltyping_apps/pheno_select/source/functions.R", echo=TRUE)
keywords <- "muscle, fatigue, heart"
Terms <- process_search_terms(keywords = keywords)
Terms
results <- MultiEWCE::load_example_results(multi_dataset = TRUE)
keywords <- "muscle, fatigue, heart"
DF <- keyword_search_df(results=results, keywords = keywords)
DF
library(shiny)
library(shint)
library(shiny)
runApp('source')
?shiny::downloadLink
runApp('web_app.R')
library(shiny); runApp('web_app.R')
runApp('source')
runApp('source')
runApp('web_app.R')
?selectInput
runApp('web_app.R')
runApp('web_app.R')
runApp('web_app.R')
runApp('web_app.R')
runApp('web_app.R')
